# Настройка игры как Telegram Mini App

## Введение

Этот документ содержит инструкции по настройке игры Warhammer 40K Loop Hero как Telegram Mini App (ранее известные как Telegram Web Apps). Следуя этим инструкциям, вы сможете интегрировать игру с платформой Telegram и предоставить пользователям возможность играть прямо в мессенджере.

## Предварительные требования

1. Аккаунт Telegram
2. Бот Telegram (создается через @BotFather)
3. Веб-сервер для размещения игры

## Шаг 1: Создание бота в Telegram

1. Откройте Telegram и найдите @BotFather
2. Отправьте команду `/newbot`
3. Следуйте инструкциям для создания нового бота
4. Сохраните полученный токен бота (Bot API Token)

## Шаг 2: Настройка игры как Telegram Mini App

1. В чате с @BotFather отправьте команду `/mybots`
2. Выберите вашего бота из списка
3. Выберите "Bot Settings" > "Menu Button" или отправьте команду `/setmenubutton`
4. Установите URL вашей игры (где она размещена на веб-сервере)
5. Установите текст для кнопки (например, "Играть")

## Шаг 3: Размещение игры на веб-сервере

1. Загрузите все файлы игры на ваш веб-сервер
2. Убедитесь, что сервер поддерживает HTTPS (это требование Telegram)
3. Проверьте, что игра доступна по URL, который вы указали в настройках бота

## Шаг 4: Настройка игры для работы в Telegram

Все необходимые файлы для интеграции с Telegram уже включены в проект:

- `js/telegramIntegration.js` - основной скрипт для интеграции с Telegram Web App API
- `telegram-styles.css` - стили для оптимизации интерфейса в Telegram
- `js/telegramTest.js` - инструмент для тестирования интеграции

## Шаг 5: Тестирование

1. Откройте вашего бота в Telegram
2. Нажмите на кнопку меню (которую вы настроили в Шаге 2)
3. Игра должна открыться в Telegram Web App
4. Используйте встроенный инструмент тестирования (кнопка "Run Telegram Tests" в правом нижнем углу), чтобы проверить работу интеграции

## Функциональность Telegram интеграции

Интеграция с Telegram предоставляет следующие возможности:

1. **Адаптивный интерфейс** - игра автоматически адаптируется под размер экрана устройства
2. **Кнопка "Назад"** - позволяет пользователям вернуться в меню или выйти из игры
3. **Главная кнопка** - используется для основных действий (начать игру, продолжить и т.д.)
4. **Сохранение прогресса** - игровой прогресс автоматически сохраняется в Telegram Cloud Storage
5. **Продолжение игры** - пользователи могут продолжить сохраненную игру при следующем запуске

## Дополнительные настройки

### Настройка автоматического сохранения

По умолчанию игра сохраняется каждые 30 секунд и после каждого хода. Вы можете изменить интервал автосохранения в файле `js/main.js`.

### Настройка интерфейса

Вы можете настроить внешний вид игры в Telegram, изменив стили в файле `telegram-styles.css`.

## Устранение неполадок

### Игра не открывается в Telegram

- Убедитесь, что URL игры доступен и использует HTTPS
- Проверьте, что все файлы правильно загружены на сервер
- Убедитесь, что в консоли браузера нет ошибок

### Проблемы с сохранением прогресса

- Проверьте, что Telegram Cloud Storage API доступен (используйте инструмент тестирования)
- Если Cloud Storage недоступен, игра автоматически использует localStorage

### Проблемы с интерфейсом

- Убедитесь, что класс `in-telegram` добавляется к body при запуске в Telegram
- Проверьте, что файл `telegram-styles.css` правильно подключен

## Заключение

После выполнения всех шагов ваша игра должна быть доступна как Telegram Mini App. Пользователи смогут играть прямо в Telegram, а их прогресс будет автоматически сохраняться.

Если у вас возникнут вопросы или проблемы, обратитесь к официальной документации Telegram Bot API и Telegram Mini Apps.