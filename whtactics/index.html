<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warhammer 40K Loop Hero</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="telegram-styles.css">
    <!-- Telegram Web App API -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // Check if running in Telegram and add class to body
        document.addEventListener('DOMContentLoaded', function() {
            if (window.Telegram && window.Telegram.WebApp) {
                document.body.classList.add('in-telegram');
            }
        });
    </script>
</head>
<body>
    <!-- Game Loader -->
    <div id="gameLoader" class="loader-screen">
        <div class="loader-content">
            <div class="warhammer-logo">
                <h1>WARHAMMER 40,000</h1>
                <h2>RELICT WAR</h2>
            </div>
            <div class="loading-spinner"></div>
            <p class="loading-text">In the grim darkness of the far future...</p>
        </div>
    </div>
    
    <!-- Main Menu -->
    <div id="mainMenu" class="menu-screen" style="display: none;">
        <div class="menu-content">
            <div class="menu-header">
                <h1>WARHAMMER 40,000</h1>
                <h2>RELICT WAR</h2>
            </div>
            <div class="menu-buttons">
                <button id="startGameBtn" class="menu-button primary">Begin the Eternal War</button>
                <button id="infoBtn" class="menu-button">Codex</button>
            </div>
        </div>
    </div>
    
    <!-- Game Setup Screen -->
    <div id="gameSetup" class="menu-screen" style="display: none;">
        <div class="setup-content">
            <h2>Prepare for Battle</h2>
            
            <div class="setup-section">
                <h3>Starting Equipment</h3>
                <div class="equipment-choice">
                    <div class="choice-item" data-choice="medkit">
                        <div class="choice-icon">‚öï</div>
                        <div class="choice-info">
                            <h4>Medi-Kit x2</h4>
                            <p>Standard Imperial medical supplies for field operations</p>
                        </div>
                    </div>
                    <div class="choice-item" data-choice="revive">
                        <div class="choice-icon">‚ö°</div>
                        <div class="choice-info">
                            <h4>Revive Pack</h4>
                            <p>Emergency revival system - restores 20% health upon death</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="setup-section">
                <h3>Emperor's Seal</h3>
                <div class="seal-choice">
                    <div class="seal-item" data-seal="shield">
                        <div class="seal-header">
                            <h4>Seal of Protection</h4>
                        </div>
                        <div class="seal-effects">
                            <div class="buff">‚¨Ü +25% Maximum health</div>
                            <div class="buff">‚¨Ü +50% Shield capacity</div>
                            <div class="debuff">‚¨á -15% Resource gathering</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="setup-actions">
                <button id="backToMenuBtn" class="menu-button">Return</button>
                <button id="startExpeditionBtn" class="menu-button primary">Begin Expedition</button>
            </div>
        </div>
    </div>
    
    <!-- Game Container (simplified for grid system) -->
    <div class="game-container wh40k-panel" id="gameContainer" style="display: none;">
        <div class="game-header wh40k-border">
            <h1 class="wh40k-title" style="font-size: 1.8rem; margin: 0;">WARHAMMER 40K GRID TACTICS</h1>
            <!-- Resource Display -->
            <div class="resource-display">
                <div class="resource-item">
                    <span class="resource-icon">üß¨</span>
                    <span class="resource-value" id="biomassCount">0</span>
                </div>
                <div class="resource-item">
                    <span class="resource-icon">‚öôÔ∏è</span>
                    <span class="resource-value" id="scrapCount">0</span>
                </div>
                <div class="resource-item">
                    <span class="resource-icon">üíé</span>
                    <span class="resource-value" id="warpstoneCount">0</span>
                </div>
            </div>
            
            <!-- Character Stats (moved from bottom) -->
            <div class="character-stats-compact" style="display: flex; gap: 10px; align-items: center; margin-left: 15px;">
                <div class="hp-display" style="display: flex; align-items: center; gap: 5px;">
                    <span style="color: #ff6666; font-size: 0.9rem;">‚ù§Ô∏è</span>
                    <span id="charHP" style="color: #ff6666; font-weight: bold;">100</span>/<span id="charMaxHP" style="color: #ccc;">100</span>
                </div>
                <div class="shield-display" style="display: flex; align-items: center; gap: 5px;">
                    <span style="color: #00ccff; font-size: 0.9rem;">üõ°Ô∏è</span>
                    <span id="charShield" style="color: #00ccff; font-weight: bold;">50</span>/<span id="charMaxShield" style="color: #ccc;">50</span>
                </div>
                <div class="stat-compact" style="display: flex; gap: 8px; font-size: 0.85rem;">
                    <span style="color: #ff8888;">‚öîÔ∏è<span id="charAttack">10</span></span>
                    <span style="color: #88ccff;">üõ°Ô∏è<span id="charDefense">5</span></span>
                    <span style="color: #88ff88;">‚ö°<span id="charSpeed">1.0</span></span>
                </div>
            </div>
            
            
            <div class="resources" style="gap: 15px; align-items: center;">
                <div class="resource resource-display" id="biomass">
                    <div class="resource-icon resource-biomass"></div>
                    <span class="wh40k-text">Biomass: <span style="color: #88ff88; font-weight: bold;">0</span></span>
                </div>
                <div class="resource resource-display" id="scrap">
                    <div class="resource-icon resource-scrap"></div>
                    <span class="wh40k-text">Scrap: <span style="color: #ffaa66; font-weight: bold;">0</span></span>
                </div>
                <div class="resource resource-display" id="warpstone">
                    <div class="resource-icon resource-warpstone"></div>
                    <span class="wh40k-text">Warpstone: <span style="color: #8888ff; font-weight: bold;">0</span></span>
                </div>
                <div class="resource resource-display" id="combatPoints">
                    <div class="resource-icon" style="background: linear-gradient(45deg, #ff6600, #ffaa00);">‚öîÔ∏è</div>
                    <span class="wh40k-text">Combat Points: <span style="color: #ff6600; font-weight: bold;">0</span></span>
                </div>
            </div>
            <div class="stats" style="gap: 15px; align-items: center;">
                <div class="stat resource-display" id="day">
                    <span class="wh40k-text">Day: <span style="color: #ffcc00; font-weight: bold;">1</span></span>
                </div>
                <div class="stat resource-display" id="loop">
                    <span class="wh40k-text">Loop: <span style="color: #ffcc00; font-weight: bold;">0</span></span>
                </div>
            </div>
        </div>
        
        <div class="game-area" style="flex: 1; display: flex; justify-content: center; align-items: center; padding: 10px;">
            <canvas id="gameCanvas" style="border: 3px solid #bb0000; border-radius: 8px; box-shadow: 0 0 30px rgba(187, 0, 0, 0.4), inset 0 0 20px rgba(0, 0, 0, 0.6); max-width: 100%; max-height: 100%;"></canvas>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <!-- Re-enabled complex systems -->
    <script src="js/classes/entity.js"></script>
    <script src="js/classes/item.js"></script>
    <script src="js/classes/character.js"></script>
    <script src="js/classes/enemy.js"></script>
    <script src="js/classes/tile.js"></script>
    <script src="js/classes/card.js"></script>
    <!-- New systems -->
    <script src="js/classes/relic.js"></script>
    <script src="js/classes/base.js"></script>
            <script src="js/classes/crafting.js"></script>
        <script src="js/classes/heroUpgrade.js"></script>
        <script src="js/classes/combat.js"></script>
        <script src="js/classes/battlefieldCard.js"></script>
        <script src="js/mapGenerator.js"></script>
    <script src="js/gameManager.js"></script>
    <script src="js/uiManager.js"></script>
    <script src="js/inventoryUI.js"></script>
    <script src="js/upgradeManager.js"></script>
    <script src="js/gridGameManager.js"></script>
    <script src="js/menuManager.js"></script>
    <script src="js/telegramIntegration.js"></script>
    <script src="js/telegramTest.js"></script>
    <script src="js/achievementManager.js"></script>
    <script src="js/main.js"></script>
</body>
</html>